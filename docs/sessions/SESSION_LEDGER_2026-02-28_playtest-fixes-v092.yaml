session_id: "2026-02-28-playtest-fixes-v092"
date: "2026-02-28"
branch: "main"
version: "0.9.2"
prior_session: "2026-02-28-viz-overhaul-audit-v091"

build_verification:
  client_typescript: "pass"
  server_typescript: "pass"
  vite_build: "pass"

commits:
  - hash: "9bbfcb2"
    message: "fix(client): 7 playtest bugs — scroll direction, mile markers, crowd noise, player warnings, death gunshot (v0.9.2)"

artifacts_updated:
  - path: "src/visualization.ts"
    change: "Reversed scroll direction for terrain, road dashes, shoulder ticks, crowd figures. Mile markers scroll with fractional progress. Grade inclinometer redesigned as vertical (12×66px). Center line more visible."
  - path: "src/audio.ts"
    change: "Crowd noise volume ~3x increase across all densities (sparse 0.04, moderate 0.08, heavy 0.14, massive 0.20)"
  - path: "src/main.ts"
    change: "Persistent lastCheckedNarrativeIdx for inter-frame warning detection. playerGunshotFired flag for player death gunshot at 3.5s delay."
  - path: "docs/CHANGELOG.md"
    change: "Added v0.9.2 entry covering all 7 playtest fixes"

decisions_made:
  - decision: "Scroll direction: all road/terrain elements scroll downward (top to bottom)"
    rationale: "Top of screen = front of pack = direction of travel. Road surface moves backward past walkers, so elements scroll from top to bottom."
  - decision: "Grade inclinometer vertical instead of horizontal"
    rationale: "User requested vertical bar with 0° at center, uphill/downhill at ends. More intuitive as a physical inclinometer/bubble level."
  - decision: "Player death gunshot at 3.5s delay"
    rationale: "Matches NPC timing pattern — warning voice plays first, then gunshot cuts it off. 3.5s is enough for the warning voice to be heard."
  - decision: "Persistent narrative index instead of per-frame snapshot"
    rationale: "UI click handlers (pee/poop) add narrative entries between frames. Per-frame snapshot misses these; persistent counter catches all."

open_questions: []

known_risks:
  - "Crowd noise volume increase may need further tuning — 3x boost might be too much in some environments"

explicitly_deferred: []

next_actions:
  - "Playtest the scroll direction and vertical grade inclinometer"
  - "Verify crowd noise volume is appropriate across different density levels"
  - "Test player death gunshot timing with the warning voice"
  - "Consider wiring up conversationFlags to influence NPC behavior (carry-forward from v0.9.1)"
